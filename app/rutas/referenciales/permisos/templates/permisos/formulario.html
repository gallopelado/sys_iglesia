{% extends 'base.html' %}
{% from 'render_elements.html' import pintar_alerta  %}

{% block title %}
{{ titulo }}
{% endblock %}

{% block content %}
<!-- MAIN CONTENT-->
<div class="main-content">
    <div class="section__content section__content--p30">
        <div class="container-fluid" id="app">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="row">
                                <div class="col col-md-3">
                                    <a href="{{ url_for('permisos.index') }}"
                                    class="btn btn-secondary bt-sm">
                                    <i class="fa fa-angle-left"></i> Volver
                                    </a>
                                </div>
                                <div class="col col-md-6">
                                    <div class="card-title">
                                        <h3 class="text-center title-2">{{ titulo }}</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <form action="{{ url_for('permisos.formulario') }}" method="post" >
                                {{ form.csrf_token }}
                                {{ form.gru_id }}
                                <div class="row">
                                    <div class="col-lg-3">
                                        {{ form.nombre_grupo.label(class="control-label mb-1") }}
                                        {{ form.nombre_grupo(class="input-sm form-control-sm form-control", disabled=True) }}
                                    </div>
                                    <div class="col-lg-4">
                                        {{ form.modulos.label(class="control-label mb-1") }}
                                        {{ form.modulos(class="input-sm form-control-sm form-control", autocomplete="off", autofocus="true", **{'v-model': 'modulos', '@click': 'getPagina()'}) }}
                                        {% for error in form.modulos.errors %}
                                        <span class="help-block" data-valmsg-for="cc-name" data-valmsg-replace="true">Revisar!</span>
                                        {% endfor %}
                                    </div>
                                </div>
                                <div class="row">
                                </div>
                                <div class="row">
                                    <div class="col-lg-5">
                                        <label class="control-label mb-1 mt-5" for="paginas">Escoger pagina</label>
                                        <select autocomplete="off" autofocus="true" class="input-sm form-control-sm form-control" id="paginas" name="paginas" v-model="paginas">
                                            <option value="">..</option>
                                            <option v-for="item in lista_paginas" v-text="item.descripcion"></option>
                                        </select>
                                    </div>
                                    <div class="col-lg-4 mt-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <h4>Marcar Permisos</h4>
                                            </div>
                                            <div class="card-body">
                                                <div class="custom-control custom-checkbox custom-control-inline form-control-sm">
                                                    {{ form.leer (class='custom-control-input') }}
                                                    {{ form.leer.label(class='custom-control-label') }}
                                                </div>
                                                <div class="custom-control custom-checkbox custom-control-inline form-control-sm">
                                                    {{ form.insertar (class='custom-control-input') }}
                                                    {{ form.insertar.label(class='custom-control-label') }}
                                                </div>
                                                <div class="custom-control custom-checkbox custom-control-inline form-control-sm">
                                                    {{ form.editar (class='custom-control-input') }}
                                                    {{ form.editar.label(class='custom-control-label') }}
                                                </div>
                                                <div class="custom-control custom-checkbox custom-control-inline form-control-sm">
                                                    {{ form.borrar (class='custom-control-input') }}
                                                    {{ form.borrar.label(class='custom-control-label') }}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 mt-3">
                                        <button type="button" class="btn btn-lg btn-success mt-5">
                                            <i class="fas fa-plus"></i> Agregar
                                        </button>
                                    </div>
                                </div>
                                <div class="row">
                                </div>
                                {{ pintar_alerta(messages) }}
                            </form>
                        </div>
                    </div>
                    <div class="card">                        
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Paginas</th>
                                        <th>Leer</th>
                                        <th>Insertar</th>
                                        <th>Editar</th>
                                        <th>Borrar</th>
                                        <th class="text-right">Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in items %}
                                    <tr>
                                        <td>{{ item['pag_nombre'] }}</td>
                                        <td><span class="role {{ 'admin' if item['leer']!='SI' else 'member' }}">{{ item['leer'] }}</span></td>
                                        <td><span class="role {{ 'admin' if item['insertar']!='SI' else 'member' }}">{{ item['insertar'] }}</span></td>
                                        <td><span class="role {{ 'admin' if item['editar']!='SI' else 'member' }}">{{ item['editar'] }}</span></td>
                                        <td><span class="role {{ 'admin' if item['borrar']!='SI' else 'member' }}">{{ item['borrar'] }}</span></td>
                                        <td>
                                            <div class="table-data-feature">
                                                <a href="{{ url_for('permisos.gestionar', id=item['id']) }}" class="btn btn-primary btn-sm mr-3">
                                                    <i class="fas fa-pencil-alt"></i> Editar
                                                </a>
                                                <a href="{{ url_for('permisos.gestionar', id=item['id']) }}" class="btn btn-danger btn-sm">
                                                    <i class="fas fa-pencil-alt"></i> Eliminar
                                                </a>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor%}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- END MAIN CONTENT-->
<!-- END PAGE CONTAINER-->
{% endblock %}

{% block mi_script %}
<script src="{{ url_for('static', filename='js/axios.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/vue.js') }}"></script>
<script type='module' src="{{ url_for('static', filename='jsOperacionales/referenciales/permisos.js') }}"></script>
{% endblock %}